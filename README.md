# Реферальная Система

Это веб-приложение на базе **FastAPI**, которое реализует систему рефералов. Пользователи могут регистрироваться, создавать реферальные коды, регистрировать новых пользователей с использованием реферальных кодов и просматривать список приглашенных пользователей.

---

## Основные функции

1. **Регистрация и аутентификация**:

   - Пользователи могут зарегистрироваться в системе.
   - После регистрации пользователь может войти в систему и получить JWT-токен для аутентификации.

2. **Создание реферального кода**:

   - Аутентифицированные пользователи могут создать уникальный реферальный код.
   - Реферальный код действителен в течение определенного времени (например, 1 день).

3. **Удаление реферального кода**:

   - Пользователи могут удалить свой активный реферальный код.

4. **Регистрация с реферальным кодом**:

   - Новые пользователи могут зарегистрироваться, используя реферальный код другого пользователя.

5. **Просмотр приглашенных пользователей**:
   - Пользователи могут просмотреть список всех пользователей, которых они пригласили с помощью своего реферального кода.

---

## Установка и запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/MaskedGod/test_ref_fast
cd referral-system
```

### 2. Создание виртуального окружения

```bash
python -m venv venv
source venv/bin/activate  # Для Linux/MacOS
venv\Scripts\activate     # Для Windows
```

### 3. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 4. Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта и добавьте следующие переменные:

```plaintext
DB_HOST=host
DB_PORT=port
DB_USER=user
DB_PASS=pass
DB_NAME=name_db
SECRET_KEY=12345678
ALGORITHM=kruchuverchu
ACCESS_TOKEN_EXPIRE_MINUTES=30
```

### 5. Запуск миграций

```bash
alembic upgrade head
```

### 6. Запуск приложения

```bash
uvicorn app.main:app --reload
```

Приложение будет доступно по адресу: [http://localhost:8000](http://localhost:8000).

Документация API доступна по адресу:

- Swagger UI: [http://localhost:8000/docs](http://localhost:8000/docs)
- ReDoc: [http://localhost:8000/redoc](http://localhost:8000/redoc)

---

## Использование системы

### 1. Регистрация нового пользователя

Отправьте POST-запрос на `/auth/register` с данными пользователя:

```json
{
  "email": "user@example.com",
  "password": "password"
}
```

### 2. Авторизация

Отправьте POST-запрос на `/auth/login` с данными пользователя:

```json
{
  "username": "user@example.com",
  "password": "password"
}
```

В ответ вы получите JWT-токен, который нужно использовать для аутентификации.

### 3. Создание реферального кода

Отправьте POST-запрос на `/referral/create` с заголовком авторизации:

```bash
Authorization: Bearer <your_token>
```

### 4. Регистрация с реферальным кодом

Отправьте POST-запрос на `/referral/register` с данными нового пользователя и реферальным кодом:

```json
{
  "email": "newuser@example.com",
  "password": "password"
}
```

Добавьте параметр `referral_code` в запрос:

```bash
/referral/register?referral_code=YOUR_REFERRAL_CODE
```

### 5. Просмотр приглашенных пользователей

Отправьте GET-запрос на `/referral/referees` с заголовком авторизации:

```bash
Authorization: Bearer <your_token>
```
